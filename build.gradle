plugins {
    id "org.scoverage" version "2.1.0"
    id "com.github.maiflai.scalatest" version "0.21"
}

apply plugin: 'java'
apply plugin: 'scala'
apply plugin: 'org.scoverage'
apply plugin: 'com.github.maiflai.scalatest'

// Code quality tools
apply plugin: 'pmd'
apply plugin: 'groovy'
apply plugin: 'checkstyle'

repositories {
    mavenCentral()
}

sourceCompatibility = jdkVersion
targetCompatibility = jdkVersion

task myJavadocs(type: Javadoc) {
    source = sourceSets.main.java
}
dependencies {
    compile 'org.scala-lang:scala-library:2.12.2'
    testCompile 'org.scalatest:scalatest_2.12:3.0.1'
    testCompile 'org.scalamock:scalamock-scalatest-support_2.12:3.5.0'
    testRuntime 'org.pegdown:pegdown:1.4.2'
    scoverage 'org.scoverage:scalac-scoverage-plugin_2.12:1.3.1'
    scoverage 'org.scoverage:scalac-scoverage-runtime_2.12:1.3.1'
    compile 'org.codehaus.groovy:groovy-all:2.0.6'
}

checkstyle {

    project.ext.checkstyleVersion = '8.9'
    project.ext.sevntuChecksVersion = '1.29.0'

    repositories {
        mavenCentral()
        // we keep artifacts in maven central too, but this is just example of usage from our old maven repo on github
        maven {
            url "http://sevntu-checkstyle.github.com/sevntu.checkstyle/maven2"
        }
    }

    ignoreFailures = true
    configFile = file("${project.rootDir}/checkstyle.xml")

    //sourceSets = [sourceSets.main]
    //showViolations = true
    //reportsDir = file("$project.buildDir/checkstyleReports")
    //configProperties = ['baseDir': "$project.projectDir"]

    //https://discuss.gradle.org/t/some-checkstyle-rules-dont-work-in-gradle/16102/4

    checkstyleMain {
        source = sourceSets.main.allSource
    }

    configurations {
        checkstyle
    }

    dependencies{
        assert project.hasProperty("checkstyleVersion")

        checkstyle "com.puppycrawl.tools:checkstyle:${checkstyleVersion}"
        checkstyle "com.github.sevntu-checkstyle:sevntu-checks:${sevntuChecksVersion}"
    }
<<<<<<< HEAD
}

jar {
    manifest {
        attributes 'Main-Class': 'it.unibo.ci.niklegend.HelloWorld'
    }
=======
>>>>>>> 4290b79ac71f9206e730eb711bd447b4035fd742
}